{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"RabbitMQ connection error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:18:58.334Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Error publishing to campaign-delivery: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:18:58.338Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Create campaign error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:18:58.339Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"RabbitMQ connection error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.074Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Error publishing to campaign-delivery: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.075Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Create campaign error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.076Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"RabbitMQ connection error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.078Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Error publishing to campaign-delivery: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.079Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Create campaign error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.079Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"RabbitMQ connection error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.243Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Error publishing to campaign-delivery: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.243Z"}
{"address":"::1","code":"ECONNREFUSED","errno":-4078,"level":"error","message":"Create campaign error: connect ECONNREFUSED ::1:5672","port":5672,"stack":"Error: connect ECONNREFUSED ::1:5672\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)","syscall":"connect","timestamp":"2025-05-11T23:19:13.244Z"}
{"_message":"Validation failed","errors":{"status":{"kind":"enum","message":"`Active` is not a valid enum value for path `status`.","name":"ValidatorError","path":"status","properties":{"enumValues":["draft","scheduled","running","completed","failed"],"fullPath":"status","message":"`Active` is not a valid enum value for path `status`.","path":"status","type":"enum","value":"Active"},"value":"Active"}},"level":"error","message":"Update campaign error: Validation failed: status: `Active` is not a valid enum value for path `status`.","stack":"ValidationError: Validation failed: status: `Active` is not a valid enum value for path `status`.\n    at _done (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:228:19)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:204:11\n    at schemaPath.doValidate.updateValidator (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:162:13)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-11T23:49:06.965Z"}
{"_message":"Validation failed","errors":{"status":{"kind":"enum","message":"`Active` is not a valid enum value for path `status`.","name":"ValidatorError","path":"status","properties":{"enumValues":["draft","scheduled","running","completed","failed"],"fullPath":"status","message":"`Active` is not a valid enum value for path `status`.","path":"status","type":"enum","value":"Active"},"value":"Active"}},"level":"error","message":"Update campaign error: Validation failed: status: `Active` is not a valid enum value for path `status`.","stack":"ValidationError: Validation failed: status: `Active` is not a valid enum value for path `status`.\n    at _done (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:228:19)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:204:11\n    at schemaPath.doValidate.updateValidator (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:162:13)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-11T23:49:14.487Z"}
{"_message":"Validation failed","errors":{"status":{"kind":"enum","message":"`Active` is not a valid enum value for path `status`.","name":"ValidatorError","path":"status","properties":{"enumValues":["draft","scheduled","running","completed","failed"],"fullPath":"status","message":"`Active` is not a valid enum value for path `status`.","path":"status","type":"enum","value":"Active"},"value":"Active"}},"level":"error","message":"Update campaign error: Validation failed: status: `Active` is not a valid enum value for path `status`.","stack":"ValidationError: Validation failed: status: `Active` is not a valid enum value for path `status`.\n    at _done (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:228:19)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:204:11\n    at schemaPath.doValidate.updateValidator (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:162:13)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-11T23:58:08.457Z"}
{"_message":"Validation failed","errors":{"status":{"kind":"enum","message":"`Active` is not a valid enum value for path `status`.","name":"ValidatorError","path":"status","properties":{"enumValues":["draft","scheduled","running","completed","failed"],"fullPath":"status","message":"`Active` is not a valid enum value for path `status`.","path":"status","type":"enum","value":"Active"},"value":"Active"}},"level":"error","message":"Update campaign error: Validation failed: status: `Active` is not a valid enum value for path `status`.","stack":"ValidationError: Validation failed: status: `Active` is not a valid enum value for path `status`.\n    at _done (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:228:19)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:204:11\n    at schemaPath.doValidate.updateValidator (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:162:13)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-12T00:00:25.912Z"}
{"_message":"Validation failed","errors":{"status":{"kind":"enum","message":"`Active` is not a valid enum value for path `status`.","name":"ValidatorError","path":"status","properties":{"enumValues":["draft","scheduled","running","completed","failed"],"fullPath":"status","message":"`Active` is not a valid enum value for path `status`.","path":"status","type":"enum","value":"Active"},"value":"Active"}},"level":"error","message":"Update campaign error: Validation failed: status: `Active` is not a valid enum value for path `status`.","stack":"ValidationError: Validation failed: status: `Active` is not a valid enum value for path `status`.\n    at _done (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:228:19)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:204:11\n    at schemaPath.doValidate.updateValidator (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:162:13)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-12T00:01:55.106Z"}
{"_message":"Validation failed","errors":{"status":{"kind":"enum","message":"`Active` is not a valid enum value for path `status`.","name":"ValidatorError","path":"status","properties":{"enumValues":["draft","scheduled","running","paused","completed","failed"],"fullPath":"status","message":"`Active` is not a valid enum value for path `status`.","path":"status","type":"enum","value":"Active"},"value":"Active"}},"level":"error","message":"Update campaign error: Validation failed: status: `Active` is not a valid enum value for path `status`.","stack":"ValidationError: Validation failed: status: `Active` is not a valid enum value for path `status`.\n    at _done (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:228:19)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:204:11\n    at schemaPath.doValidate.updateValidator (D:\\crm\\server\\node_modules\\mongoose\\lib\\helpers\\updateValidators.js:162:13)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-12T00:04:26.023Z"}
{"_message":"Segment validation failed","errors":{"rules.0.operator":{"kind":"required","message":"Path `operator` is required.","name":"ValidatorError","path":"operator","properties":{"message":"Path `operator` is required.","path":"operator","type":"required","value":""},"value":""}},"level":"error","message":"Create segment error: Segment validation failed: rules.0.operator: Path `operator` is required.","stack":"ValidationError: Segment validation failed: rules.0.operator: Path `operator` is required.\n    at Document.invalidate (D:\\crm\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at Subdocument.invalidate (D:\\crm\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\document.js:3104:17\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-12T00:34:55.359Z"}
{"_message":"Segment validation failed","errors":{"rules.0.field":{"kind":"required","message":"Path `field` is required.","name":"ValidatorError","path":"field","properties":{"message":"Path `field` is required.","path":"field","type":"required","value":""},"value":""},"rules.0.operator":{"kind":"required","message":"Path `operator` is required.","name":"ValidatorError","path":"operator","properties":{"message":"Path `operator` is required.","path":"operator","type":"required","value":""},"value":""}},"level":"error","message":"Create segment error: Segment validation failed: rules.0.field: Path `field` is required., rules.0.operator: Path `operator` is required.","stack":"ValidationError: Segment validation failed: rules.0.field: Path `field` is required., rules.0.operator: Path `operator` is required.\n    at Document.invalidate (D:\\crm\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at Subdocument.invalidate (D:\\crm\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\document.js:3104:17\n    at D:\\crm\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11)","timestamp":"2025-05-12T00:39:51.972Z"}
{"code":"ERR_INVALID_URL","input":"undefined/api/communications/receipt","level":"error","message":"Error sending delivery receipt: Invalid URL","stack":"TypeError [ERR_INVALID_URL]: Invalid URL\n    at new NodeError (node:internal/errors:405:5)\n    at new URL (node:internal/url:637:13)\n    at dispatchHttpRequest (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2801:20)\n    at D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2721:5\n    at new Promise (<anonymous>)\n    at wrapAsync (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2701:10)\n    at http (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2739:10)\n    at Axios.dispatchRequest (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4116:10)\n    at Axios._request (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4416:33)\n    at Axios.request (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4271:25)\n    at Axios.request (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4276:41)\n    at async VendorAPIService.sendDeliveryReceipt (D:\\crm\\server\\src\\services\\vendor-api.service.js:62:7)\n    at async Timeout._onTimeout (D:\\crm\\server\\src\\services\\vendor-api.service.js:36:11)","timestamp":"2025-05-12T00:40:07.587Z"}
{"code":"ERR_INVALID_URL","input":"undefined/api/communications/receipt","level":"error","message":"Error sending delivery receipt: Invalid URL","stack":"TypeError [ERR_INVALID_URL]: Invalid URL\n    at new NodeError (node:internal/errors:405:5)\n    at new URL (node:internal/url:637:13)\n    at dispatchHttpRequest (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2801:20)\n    at D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2721:5\n    at new Promise (<anonymous>)\n    at wrapAsync (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2701:10)\n    at http (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:2739:10)\n    at Axios.dispatchRequest (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4116:10)\n    at Axios._request (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4416:33)\n    at Axios.request (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4271:25)\n    at Axios.request (D:\\crm\\server\\node_modules\\axios\\dist\\node\\axios.cjs:4276:41)\n    at async VendorAPIService.sendDeliveryReceipt (D:\\crm\\server\\src\\services\\vendor-api.service.js:62:7)\n    at async Timeout._onTimeout (D:\\crm\\server\\src\\services\\vendor-api.service.js:36:11)","timestamp":"2025-05-12T00:40:07.588Z"}
{"level":"error","message":"Update segment error: No matching document found for id \"68214364f1db5b35491a7eb0\" version 0 modifiedPaths \"rules, customerCount\"","modifiedPaths":["rules","customerCount"],"stack":"VersionError: No matching document found for id \"68214364f1db5b35491a7eb0\" version 0 modifiedPaths \"rules, customerCount\"\n    at generateVersionError (D:\\crm\\server\\node_modules\\mongoose\\lib\\model.js:572:10)\n    at model.save (D:\\crm\\server\\node_modules\\mongoose\\lib\\model.js:630:28)\n    at D:\\crm\\server\\src\\routes\\segment.routes.js:226:19\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-05-12T00:54:52.565Z","version":0}
